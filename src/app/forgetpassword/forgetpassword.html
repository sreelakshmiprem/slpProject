<div class="reset-password-container">
  <h2>Reset Password</h2>

  <form [formGroup]="resetForm" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label for="email">Username</label>
      <input type="email" id="email" formControlName="email" readonly class="form-control"
        style="background-color:#e9ecef; cursor:not-allowed;" />
    </div>

    <div class="form-group password-group">
      <label for="password">New Password</label>
      <div class="password-wrapper">
        <input [type]="showPassword ? 'text' : 'password'" id="password" formControlName="password"
          placeholder="Enter your password" />
        <i class="bi" [ngClass]="showPassword ? 'bi-eye-slash' : 'bi-eye'" (click)="togglePasswordVisibility('new')"></i>
      </div>
      @if (f['password'].touched && f['password'].invalid) {
        <div class="error-message">
          @if (f['password'].errors?.['required']) {
            <span>Password is required.</span>
          }
          @if (f['password'].errors?.['pattern']) {
            <span>Password must be 8â€“64 chars, include 1 uppercase, 1 lowercase, 1 digit, and 1 special character.</span>
          }
        </div>
      }
    </div>

    <div class="form-group password-group">
      <label for="confirmPassword">Confirm Password</label>
      <div class="password-wrapper">
        <input [type]="showConfirmPassword ? 'text' : 'password'" id="confirmPassword" formControlName="confirmPassword"
          placeholder="Confirm password" />
        <i class="bi" [ngClass]="showConfirmPassword ? 'bi-eye-slash' : 'bi-eye'" (click)="togglePasswordVisibility('confirm')"></i>
      </div>
      @if (f['confirmPassword'].touched && f['confirmPassword'].invalid) {
        <div class="error-message">
          <span>Confirmation is required.</span>
        </div>
      }
      @if (f['password'].value && f['confirmPassword'].value && f['password'].value !== f['confirmPassword'].value) {
        <div class="error-message">
          <span>Passwords do not match.</span>
        </div>
      }
    </div>

    <div class="honeypot">
      <input type="text" formControlName="extraField" (focus)="onHoneypotFocus()" (blur)="onHoneypotBlur()" hidden />
    </div>

    @if (isLoading) {
      <div class="spinner-overlay">
        <div class="spinner"></div>
      </div>
    }

    <button type="submit" [disabled]="resetForm.invalid">Reset Password</button>
  </form>
</div>